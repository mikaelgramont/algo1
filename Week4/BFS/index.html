<!DOCTYPE html>
<html>
<head>
<title>BFS tests</title>
<style>
body {
	font-family: Helvetica;
}
ul, li {
	margin: 0;
	padding: 0;	
}
ul {
	list-style: none;
}
.container {
	width: 400px;
	height: 400px;
}
.list {
	position: relative;
	width: 100%;
	height: 100%;
}
.cell {
	position: absolute;
	display: flex;
	justify-content: center;
	align-items: center;
}
.num {
	display: inline-block;
	border-radius: 20px;
	padding: 10px;
	background: rgba(255, 255, 255, .5);
	color: #333;
}
.first p {
	border: 3px solid red;
}
.last p {
	border: 3px solid black;
}
</style>
</head>
<body>
	<div class="container">
	</div>

	<script>
		var xDiv = 5,
			yDiv = 5;

		var cont = document.getElementsByClassName('container')[0];
		var frag = document.createDocumentFragment();
		var list = document.createElement('ul');
		var cells = [];
		var nums = [];

		list.classList.add('list');
		for (var i = 0; i < xDiv; i++) {
			for (var j = 0; j < yDiv; j++) {
				var cell = document.createElement('li');
				cell.classList.add('cell');
				cell.style.width = 100 / xDiv + '%';
				cell.style.top = i * 100 / xDiv + '%';
				cell.style.height = 100 / yDiv + '%';
				cell.style.left = j * 100 / xDiv + '%';

				var num = document.createElement('p');
				num.classList.add('num');
				cell.appendChild(num);
				nums.push(num);

				var hue = Math.round(Math.random() * 255);
				cell.dataset.hue = hue;
				cell.style.background = 'hsl(' + hue + ', 100%, 90%)';
				list.appendChild(cell);

				cells.push(cell);
			}
		}
		frag.appendChild(list);
		cont.appendChild(frag);

		var graph = [
			[1],
			[0],
			[3],
			[2, 4],
			[3, 9],

			[10],
			[11, 7],
			[6, 12],
			[9, 13],
			[4, 8],

			[5, 15],
			[6, 16],
			[7, 17],
			[8, 18],
			[19],

			[10, 16, 20],
			[11, 15, 21],
			[12, 18, 22],
			[13, 17, 19, 23],
			[14, 18, 24],

			[15, 21],
			[16, 20],
			[17, 23],
			[18, 22],
			[19]
		];

		var l = graph.length;
		var explored = [];
		for (var i = 0; i < l; i++) {
			explored[i] = 0;
		}
		var exploredCount = 0;

		function bfs(g, startId, fn, cells) {
			markCellVisited(startId);
			markCellFirst(startId);
			var q = new Queue();
			q.push(startId); // s

			var currentId = startId; // v

			while((currentId = q.pop()) !== undefined) {				
				var lastId = currentId;

				var nbConnectedNodes = g[currentId].length;
				for (var i = 0; i < nbConnectedNodes; i++) {
					var connectedNodeId = g[currentId][i];
					if (!explored[connectedNodeId]) {
						fn(connectedNodeId);
						q.push(connectedNodeId);
					}
				}
			}
			markCellLast(lastId);
		}

		function markCellVisited(id) {
			explored[id] = 1;
			var cell = cells[id];
			var hue = cell.dataset.hue;
			cell.style.background = 'hsl(' + hue + ', 100%, 30%)';
			nums[id].innerText = exploredCount++;
		}

		function markCellFirst(id) {
			cells[id].classList.add('first');
		}

		function markCellLast(id) {
			cells[id].classList.add('last');	
		}

		function pickUnexploredNode(g) {
			var l = explored.length;
			for (var i = 0; i < l; i++) {
				if (!explored[i]) {
					return i;
				}
			}
			return null;
		}

		var Queue = function() {
			this.arr = [];
		};
		Queue.prototype.push = function(node) {
			this.arr.push(node);
		}
		Queue.prototype.pop = function() {
			return this.arr.shift();
		}

		// Get this party started.
		var topLevelNodeId;
		while ((topLevelNodeId = pickUnexploredNode(graph)) !== null) {
			bfs(graph, topLevelNodeId, markCellVisited, cells);	
		}
		
	</script>
</body>
</html>